{{ define "main" }}

<div class="grid">
    <div>
        <form id="filterer" action="#" @submit.prevent="">
            <fieldset>
                <label>filter by name
                    <div role="search">
                        <input type="search" placeholder="filter..." x-model="nameFilter" />
                        <input type="reset" value="clear" @click.prevent="nameFilter = ''" />
                    </div>
                </label>
            </fieldset>

            <fieldset class="grid">
                <label>
                    min keys: <span x-text="minKeys"></span>
                    <input type="range" min="0" max="150" x-model="minKeys" />
                </label>
                <label>
                    max keys: <span x-text="maxKeys"></span>
                    <input type="range" min="0" max="150" x-model="maxKeys" />
                </label>
            </fieldset>

            <fieldset class="bordered">
              <legend>Layouts:</legend>
                <button :class="filterClass(layouts.ergo)" @click="toggleLayout('ergo')">Ergonomic</button>
                <button :class="filterClass(layouts.dish)" @click="toggleLayout('dish')">Dished</button>
                <button :class="filterClass(layouts.ortho)" @click="toggleLayout('ortho')">Ortholinear</button>
                <button :class="filterClass(layouts.traditional)" @click="toggleLayout('traditional')">Traditional</button>
                <button :class="filterClass(layouts.other)" @click="toggleLayout('other')">Other</button>
            </fieldset>

        </form>
    </div>
    <div>
        <fieldset class="bordered">
            <legend>Features:</legend>
            <button :class="filterClass(features.split)" @click="toggleFeature('split')">Split</button>
            <button :class="filterClass(features.encoder)" @click="toggleFeature('encoder')">Encoder</button>
            <button :class="filterClass(features.track)" @click="toggleFeature('track')">Track</button>
            <button :class="filterClass(features.display)" @click="toggleFeature('display')">Display</button>
            <button :class="filterClass(features.wireless)" @click="toggleFeature('wireless')">Wireless</button>
        </fieldset>
        <fieldset class="bordered">
          <legend>Required Open Source:</legend>
          <label>
            <input name="openHardware" type="checkbox" role="switch" x-model="openHardwareOnly" />
                hardware
          </label>
        </fieldset>
    </div>
</div>

<hr />

<div class="overflow-auto">
    <table class="striped">
        <thead>
            <tr>
                <th scope="col"><span x-text="resultCount"></span> results</th>
                <th scope="col">Name {{ partial "sort-icon.html" "name" }}</th>
                <th scope="col">Layout {{ partial "sort-icon.html" "layout" }}</th>
                <th scope="col">Keys{{ partial "sort-icon.html" "keys" }}</th>
                <th scope="col">Features {{ partial "sort-icon.html" "featuresCount" }}</th>
                <th scope="col">GitHub?</th>
                <!-- <th scope="col">Website</th> -->
            </tr>
        </thead>
        <tbody>
            <template x-for="kb in filteredData()">
                <tr>
                    <td><img class="thumb" :src="kb.thumbUrl" :alt="kb.name" @click="$dispatch('lightbox', kb.imageUrl)"/></td>
                    <td ><a :href="kb.website" x-text="kb.name" target="_blank" ></a></td>
                    <td x-text="kb.layout"></td>
                    <td x-text="kb.keysRange"></td>
                    <td x-text="`${kb.features.join(', ')}`"></td>
                    <td :class="kb.openHardware ? 'good' : 'bad'">
                        <i x-show="kb.openHardware" class="fa-solid fa-check good"></i>
                        <i x-show="!kb.openHardware" class="fa-solid fa-xmark bad"></i>
                    </td>
                    <!-- <td> -->
                    <!--     <img alt="??" :src="kb.websiteShield"> -->
                    <!-- </td> -->
                </tr>
            </template>
        </tbody>
    </table>
</div>


<div class="lightbox" x-data="{lightboxOpen: false, imgSrc: ''}" x-show="lightboxOpen" x-transition
@lightbox.window="lightboxOpen = true; imgSrc = $event.detail; console.log($event.detail)">
<div class="lightbox-container">
  <img :src="imgSrc" @click="lightboxOpen = false" @click.away="lightboxOpen = false">
</div>
</div>
{{ end }}
